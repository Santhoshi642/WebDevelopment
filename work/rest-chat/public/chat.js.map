{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/chat.js","webpack:///./src/services.js"],"names":["appState","pollId","isLoggedIn","usersList","messagesList","error","users","document","querySelector","messages","outgoing","logout","sendMessage","login","renderLogin","show","innerHTML","poll","renderErrors","text","shouldPoll","setInterval","fetchLists","err","code","renderPage","then","usersMessagesList","renderLists","clearTimeout","renderUsersList","renderMessagesList","Object","values","filter","user","active","map","username","join","message","timestamp","renderMessageInput","renderLogout","addEventListener","e","target","classList","contains","value","fetchLogIn","messageText","fetchSendMessage","fetchLogout","fetchLoginStatus","fetch","method","headers","Headers","body","JSON","stringify","Promise","reject","response","ok","json","result"],"mappings":"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","file":"chat.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/chat.js\");\n","import {\r\n  fetchLogIn,\r\n  fetchLoginStatus,\r\n  fetchLists,\r\n  fetchSendMessage,\r\n  fetchLogout\r\n} from './services';\r\n\r\nconst appState = {\r\n  pollId: null,\r\n  isLoggedIn: false,\r\n  usersList: {},\r\n  messagesList: [],\r\n  error: '',\r\n};\r\n\r\nconst users = document.querySelector('.users-list');\r\nconst messages = document.querySelector('.messages-list');\r\nconst outgoing = document.querySelector('.send-message');\r\nconst logout = document.querySelector('.logout');\r\nconst sendMessage = document.querySelector('.send-message');\r\nconst login = document.querySelector('.login');\r\n\r\nfunction renderLogin( show ) {\r\n  const login = document.querySelector('.login');\r\n  if(show) {\r\n    login.innerHTML = `\r\n      <label>Username: <input/></label>\r\n      <button class=\"to-login\" type=\"button\">Login</button>\r\n    `;\r\n    users.innerHTML = ``;\r\n    messages.innerHTML = ``;\r\n    logout.innerHTML = ``;\r\n    sendMessage.innerHTML = ``;\r\n    poll(false);\r\n  } else {\r\n    login.innerHTML = ``;\r\n  }\r\n}\r\n\r\nfunction renderErrors( text ) {\r\n  document.querySelector('.status').innerHTML = text;\r\n}\r\n\r\nfunction poll(shouldPoll) {\r\n  if( shouldPoll && !appState.pollId ) {\r\n    appState.pollId = setInterval( () => {\r\n      fetchLists()\r\n      .catch( (err) => {\r\n        appState.error = err.code;\r\n        if(err.code != 'network-error'){\r\n          appState.isLoggedIn = false;\r\n        }\r\n        renderPage();\r\n      })\r\n      .then( (usersMessagesList) => {\r\n        appState.error = '';\r\n        appState.usersList = usersMessagesList.usersList;\r\n        appState.messagesList = usersMessagesList.messagesList;\r\n        renderLists(appState.usersList, appState.messagesList);\r\n      });\r\n    }, 5000);\r\n  }\r\n  if( !shouldPoll && appState.pollId ) {\r\n    clearTimeout(appState.pollId);\r\n    appState.pollId = null;\r\n  }\r\n}\r\n\r\nfunction renderLists( usersList, messagesList ) {\r\n  renderUsersList(usersList);\r\n  renderMessagesList(messagesList);\r\n}\r\n\r\nfunction renderUsersList(usersList){\r\n  users.innerHTML = `<ul class=\"users\">` +\r\n  Object.values(usersList).filter( user => user.active).map( user => `\r\n  <li>\r\n    <div class=\"user\">\r\n      <span class=\"username\">${user.username}</span>\r\n    </div>\r\n  </li>\r\n  `).join('') +\r\n  `</ul>`;\r\n}\r\n\r\nfunction renderMessagesList(messagesList){\r\n  messages.innerHTML = `<ol class=\"messages\">` +\r\n  messagesList.map( message => `\r\n    <li>\r\n      <div class=\"message\">\r\n        <div class=\"meta-info\">\r\n          <div class=\"sender-info\">\r\n            <span class=\"username\">${message.username}</span>\r\n          </div>\r\n          <div class=\"message-info\">\r\n            <span class=\"time-stamp\">${message.timestamp}</span>\r\n          </div>\r\n        </div>\r\n        <p class=\"message-text\">${message.text}</p>\r\n      </div>\r\n    </li>\r\n  `).join('') +\r\n  `</ol>`;\r\n}\r\n\r\nfunction renderMessageInput(){\r\n  outgoing.innerHTML = `\r\n    <input class=\"to-send\" name=\"text\" value=\"\" placeholder=\"Enter message to send\"/>\r\n    <button class=\"send-button\" type=\"submit\">Send</button>`;\r\n}\r\n\r\nfunction renderLogout(){\r\n  logout.innerHTML = ` <button class=\"logout-button\" type=\"button\">Logout</button>`;\r\n}\r\n\r\nfunction renderPage() {\r\n  if(!appState.isLoggedIn)  {\r\n    renderLogin(true);\r\n  } else {\r\n    renderLogin(false);\r\n    renderLists(appState.usersList, appState.messagesList);\r\n    renderMessageInput();\r\n    renderLogout();\r\n  }\r\n  renderErrors(appState.error);\r\n}\r\n\r\nlogin.addEventListener('click', (e) => {\r\n  if(!e.target.classList.contains('to-login')) {\r\n    return;\r\n  }\r\n  const username = login.querySelector('input').value;\r\n  fetchLogIn(username)\r\n  .then( (usersMessagesList) => {\r\n    appState.isLoggedIn = true;\r\n    appState.usersList = usersMessagesList.usersList;\r\n    appState.messagesList = usersMessagesList.messagesList;\r\n    appState.error = '';\r\n    poll(true);\r\n    renderPage();\r\n  })\r\n  .catch( (err) => {\r\n    appState.isLoggedIn = false;\r\n    appState.error = err.code;\r\n    renderPage();\r\n  });\r\n});\r\n\r\nsendMessage.addEventListener('click', (e) => {\r\n  if(!e.target.classList.contains('send-button')) {\r\n    return;\r\n  }\r\n  const messageText = sendMessage.querySelector('.to-send').value;\r\n  fetchSendMessage(messageText)\r\n  .then( (usersMessagesList) => {\r\n    appState.isLoggedIn = true;\r\n    appState.usersList = usersMessagesList.usersList;\r\n    appState.messagesList = usersMessagesList.messagesList;\r\n    appState.error = '';\r\n    renderPage();\r\n  })\r\n  .catch( (err) => {\r\n    appState.error = err.code;\r\n    renderPage();\r\n  });\r\n});\r\n\r\nlogout.addEventListener('click', (e) => {\r\n  if(!e.target.classList.contains('logout-button')) {\r\n    return;\r\n  }\r\n  fetchLogout()\r\n  .then( () => {\r\n    appState.isLoggedIn = false;\r\n    appState.error = '';\r\n    renderPage();\r\n  })\r\n  .catch( (err) => {\r\n    appState.isLoggedIn = false;\r\n    appState.error = err.code;\r\n    renderPage();\r\n  });\r\n});\r\n\r\nfetchLoginStatus()\r\n.then( () => {\r\n  fetchLists()\r\n  .catch( (err) => {\r\n    appState.isLoggedIn = false;\r\n    appState.error = err.code;\r\n    renderPage();\r\n  })\r\n  .then( (usersMessagesList) => {\r\n    appState.error = '';\r\n    appState.usersList = usersMessagesList.usersList;\r\n    appState.messagesList = usersMessagesList.messagesList;\r\n    appState.isLoggedIn = true;\r\n    poll(true);\r\n    renderPage();\r\n  });\r\n})\r\n.catch( (err) => {\r\n  if(err.code != 'Initial Login'){\r\n    appState.error = err.code;\r\n  }\r\n  appState.isLoggedIn = false;\r\n  renderPage();\r\n});","export const fetchLogIn = (username) => {\r\n  return fetch('/session', {\r\n    method: 'POST',\r\n    headers: new Headers({\r\n      'content-type': 'application/json',\r\n    }),\r\n    body: JSON.stringify({ username }),\r\n  })\r\n  .catch( () => {\r\n    return Promise.reject({code: 'network-error'});\r\n  })\r\n  .then( (response) => {\r\n    if(!response.ok) {\r\n      return response.json().then( result => Promise.reject(result) );\r\n    }\r\n    return response.json();\r\n  });\r\n};\r\n\r\nexport const fetchLoginStatus = () => {\r\n  return fetch('/session', {\r\n    method: 'GET',\r\n  })\r\n  .catch( () => {\r\n    return Promise.reject({code: 'network-error'});\r\n  })\r\n  .then( (response) => {\r\n    if(!response.ok) {\r\n      return response.json().then( result => Promise.reject(result) );\r\n    }\r\n    return;\r\n  })\r\n};\r\n\r\nexport const fetchLists = () => {\r\n  return fetch('/lists', {\r\n    method: 'GET',\r\n  })\r\n  .catch( () => {\r\n    return Promise.reject({code: 'network-error'});\r\n  })\r\n  .then( (response) => {\r\n    if(!response.ok) {\r\n      return response.json().then( result => Promise.reject(result) );\r\n    }\r\n    return response.json();\r\n  });\r\n};\r\n\r\nexport const fetchSendMessage = (messageText) => {\r\n  return fetch('/lists', {\r\n    method: 'POST',\r\n    headers: new Headers({\r\n      'content-type': 'application/json',\r\n    }),\r\n    body: JSON.stringify({ messageText }),\r\n  })\r\n  .catch( () => {\r\n    return Promise.reject({code: 'network-error'});\r\n  })\r\n  .then( (response) => {\r\n    if(!response.ok) {\r\n      return response.json().then( result => Promise.reject(result) );\r\n    }\r\n    return response.json();\r\n  });\r\n};\r\n\r\nexport const fetchLogout = () => {\r\n  return fetch('/session', {\r\n    method: 'DELETE'\r\n  })\r\n  .catch( () => {\r\n    return Promise.reject({code: 'network-error'});\r\n  })\r\n  .then( (response) => {\r\n    if(!response.ok) {\r\n      return response.json().then( result => Promise.reject(result) );\r\n    }\r\n    return;\r\n  });\r\n};"],"sourceRoot":""}